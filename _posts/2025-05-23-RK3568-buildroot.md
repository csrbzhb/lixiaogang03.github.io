---
layout:     post
title:      RK3568 Buildroot
subtitle:   linux
date:       2025-05-23
author:     LXG
header-img: img/post-bg-xiaomi.jpg
catalog: true
tags:
    - linux
---

Rockchip_Developer_Guide_Linux_Software_CN.pdf

Rockchip_Developer_Guide_Buildroot_CN.pdf

## buildroot 添加 ffmpeg

```diff

diff --git a/buildroot/configs/rockchip/multimedia/ffmpeg.config b/buildroot/configs/rockchip/multimedia/ffmpeg.config
new file mode 100644
index 000000000..34eadb644
--- /dev/null
+++ b/buildroot/configs/rockchip/multimedia/ffmpeg.config
@@ -0,0 +1,2 @@
+BR2_PACKAGE_FFMPEG=y
+BR2_PACKAGE_FFMPEG_SWSCALE=y
diff --git a/buildroot/configs/rockchip_rk3568_defconfig b/buildroot/configs/rockchip_rk3568_defconfig
index 0637322b6..4e44f2449 100644
--- a/buildroot/configs/rockchip_rk3568_defconfig
+++ b/buildroot/configs/rockchip_rk3568_defconfig
@@ -6,6 +6,7 @@
 #include "fs/vfat.config"
 #include "gpu/gpu.config"
 #include "multimedia/audio.config"
+#include "multimedia/ffmpeg.config"
 #include "multimedia/camera.config"
 #include "multimedia/gst/audio.config"
 #include "multimedia/gst/camera.config"

```

**编译**

./build.sh buildroot

## USB Gadget

Rockchip_Quick_Start_Linux_USB_Gadget_CN.pdf

Rockchip_Trouble_Shooting_Linux4.19_USB_Gadget_UVC_CN.pdf

**kernel/arch/arm64/configs/rockchip_linux_defconfig**

```sh

CONFIG_USB_GADGET=y
CONFIG_USB_GADGET_DEBUG_FILES=y
CONFIG_USB_GADGET_VBUS_DRAW=500
CONFIG_USB_CONFIGFS=y
CONFIG_USB_CONFIGFS_UEVENT=y
CONFIG_USB_CONFIGFS_ACM=y
CONFIG_USB_CONFIGFS_RNDIS=y
CONFIG_USB_CONFIGFS_MASS_STORAGE=y
CONFIG_USB_CONFIGFS_F_FS=y
CONFIG_USB_CONFIGFS_F_UAC1=y
CONFIG_USB_CONFIGFS_F_UAC1_LEGACY=y
CONFIG_USB_CONFIGFS_F_UAC2=y
CONFIG_USB_CONFIGFS_F_MIDI=y
CONFIG_USB_CONFIGFS_F_HID=y
CONFIG_USB_CONFIGFS_F_UVC=y


```

**RKScript中，有三个USB相关文件：**

```sh

S50usbdevice # /etc/init.d/ 使用时，配合同级目录的.usb_config使用
usbdevice # /usr/bin/
61-usbdevice.rules # /lib/udev/rules.d/

#还有两个相关文件需要用户自建或修改
.usb_config # /etc/init.d/
/tmp/.usb_config # S50usbdevice 自动生成

```

**./buildroot/output/rockchip_rk3568/target/etc/init.d/S50usbdevice.sh**

```sh

#!/bin/sh
### BEGIN INIT INFO
# Provides:       usbdevice
# Required-Start: $local_fs $syslog
# Required-Stop:  $local_fs
# Default-Start:  S
# Default-Stop:   K
# Description:    Manage USB device functions
### END INIT INFO

case "$1" in
	start|stop|restart)
		/sbin/start-stop-daemon -Sbx /usr/bin/usbdevice $1
		;;
	*)
		echo "Usage: [start|stop|restart]" >&2
		exit 3
		;;
esac

:

```







