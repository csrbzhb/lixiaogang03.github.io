---
layout:     post
title:      嵌入式开发
subtitle:   面试题
date:       2025-03-14
author:     LXG
header-img: img/post-bg-board.jpg
catalog: true
tags:
    - linux
---

[基于stm32F407嵌入式底层驱动开发实践](https://stm32f407-tech-doc.readthedocs.io/en/latest/index.html)

## 硬件

### GPIO

#### 什么是 上拉电阻（Pull-up） 和 下拉电阻（Pull-down）？它们的作用是什么？

```txt

上拉电阻（Pull-up Resistor） 和 下拉电阻（Pull-down Resistor） 是用于稳定数字电路输入端状态的电子元件，防止输入端悬空（Floating），导致不确定的逻辑状态。

上拉电阻：默认 高电平，防止输入端悬空，常用于 I2C、UART、开漏电路 等。
下拉电阻：默认 低电平，确保输入端稳定，常用于 按键输入、使能信号 等。
内置上拉/下拉：现代 MCU 可通过软件配置内部上拉/下拉，无需外部电阻

```

#### 什么是 开漏输出（Open Drain） 和 推挽输出（Push-Pull）？它们的应用场景是什么？

| **特性**  | **开漏输出（Open Drain）** | **推挽输出（Push-Pull）** |
|----------|------------------|------------------|
| **能否主动输出高电平** | **不能**（需要外部上拉） | **能**（直接输出 VCC） |
| **能否主动输出低电平** | 能（MOSFET 导通接地） | 能（下管导通接地） |
| **是否需要外部上拉电阻** | **需要** | **不需要** |
| **适用于总线通信** | **适用于 I2C、信号共享** | 不适合 |
| **适用于高速信号** | **不适合** | **适用于 SPI、UART** |
| **驱动能力** | 适合驱动外部大功率负载 | 适合直接驱动小型负载 |
| **功耗** | 取决于上拉电阻值 | **较低** |

#### 如何在 C 代码中实现一个 GPIO 的按键检测，并带去抖动功能？

| **方法**               | **优点**              | **缺点**              | **适用场景**              |
|------------------------|-----------------------|-----------------------|---------------------------|
| **软件延时去抖动**      | 简单、易实现          | `HAL_Delay()` 影响其他任务 | 低频按键，单任务应用      |
| **定时器+中断去抖动**   | **非阻塞，高可靠**    | 需配置定时器，稍复杂   | 需要高可靠性、频繁检测    |

### 中断

#### 在中断服务程序（ISR）中应该避免哪些操作？

| **操作**                         | **原因**                                         |
|----------------------------------|--------------------------------------------------|
| 长时间的延时操作                 | 影响系统响应和其他中断处理                        |
| 动态内存分配（如 malloc/free）   | 可能导致堆栈溢出或内存碎片，影响系统稳定性          |
| 阻塞的 I/O 操作                  | 增加 ISR 执行时间，导致其他中断无法及时响应         |
| 修改共享资源而不同步             | 可能引起数据竞争，导致数据不一致                  |
| 调用复杂函数（如递归）           | 可能导致栈溢出和系统不稳定                         |
| 中断嵌套                         | 增加系统复杂性，可能导致栈溢出或延迟响应             |
| 使用浮点运算                     | 运算速度慢，并增加上下文切换的开销                  |
| 修改中断使能标志                 | 可能导致系统无法响应其他重要中断                  |

### 定时器与 PWM

#### 什么是 PWM（脉冲宽度调制）？使用场景是什么？

```txt

PWM（脉冲宽度调制）是一种通过在固定频率下改变数字信号中高电平持续时间（即脉冲宽度）来调节平均输出功率的技术。通过控制输出信号的占空比（Duty Cycle），可以实现对负载所施加电压或功率的精确控制，而无需使用模拟电路

现代 MCU 通常内置定时器/计数器模块，可配置为 PWM 模式。首先需要设置 PWM 的频率（周期）和计数器模式。设置占空比, 配置好定时器后，将 PWM 信号输出到相应的 GPIO 引脚，连接到 LED、电机或其他负载。

LED 调光：
通过改变 PWM 信号的占空比，可以控制 LED 的亮度。占空比越高，LED 亮度越高；占空比低时，LED 亮度降低。

电机速度控制：
在直流电机控制中，PWM 用于调整电机的平均输入电压，从而实现调速。较高的占空比可使电机转速更快，而较低的占空比则使电机转速降低。

音频信号生成：
通过快速切换 PWM 信号，可以生成音频波形。常用于数字音频输出和音调控制。

电源管理：
在开关电源（SMPS）中，PWM 用于调节输出电压和电流，通过控制开关管的导通时间来实现高效能量转换。

伺服控制：
一些伺服电机控制需要通过 PWM 信号来设定精确的位置和角度。

```

#### 介绍下STM32的看门狗用法

```txt

独立看门狗（IWDG, Independent Watchdog）

IWDG 基于低速内部振荡器（LSI），独立于系统主时钟运行，因此即使系统主时钟出问题或软件异常导致主程序挂起，IWDG 仍能正常工作并复位系统。

窗口看门狗（WWDG, Window Watchdog）

WWDG 是基于系统时钟的看门狗，与 IWDG 不同，WWDG 提供一个“刷新窗口”概念。也就是说，只有在特定的时间窗口内刷新计数器才是有效的，过早或过晚刷新都会被认为异常，从而触发复位。

```





















